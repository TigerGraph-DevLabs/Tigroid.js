<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tigroid test</title>
    
    <style>
	    #cy {
	  		width: 1000px;
	  		height: 800px;
	  		display: block;
	  		border: 1px solid #f0f0f0;
	  		margin: 5px;
	  		padding: 2px;
			}
    </style>
</head>
<body>
<div id="tgres" style="width: 100%; border: 1px solid #f0f0f0; margin: 5px; padding: 2px; font-family: Calibri, Helvetica, Arial, sans-serif"></div>
<div id="cy">
<script src="scripts/tigroid.js"></script>
<script src="scripts/tigroidcytoscape.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.15.2/cytoscape.min.js"></script>
<script>
	conn = new Tigroid({restppPort: "8080", gsPort: "8080", graphname: "MyGraph", apiToken: "el1op7a9eqrlq4ape5t452lukv991k7h", debug: true});

	var tgres = document.getElementById('tgres');
	var cy = cytoscape({
	  container: document.getElementById('cy'), // container to render in
	  
		  style: [ // the stylesheet for the graph
		    {
		      selector: 'node',
		      style: {
			    'label': 'data(v_id)',
		        'color': 'back',
		        'text-valign': 'bottom',
		        "font-size": '10px',
		        'border-width': '1px',
		        'border-color': '#808080'
		      }
		    },
		    {
		    	selector: '[v_type = \"Country\"]',
		    	style: {
		            'background-color': '#C6E0B4',
		        },
		    },
		    {
		    	selector: '[v_type = \"Province\"]',
		    	style: {
		            'background-color': '#FFE699',
		        },
		    },

		    {
		      selector: 'edge',
		      style: {
		        'width': 3,
		        'line-color': '#ccc',
		        'target-arrow-color': '#ccc',
		        'target-arrow-shape': 'triangle',
		        'curve-style': 'bezier'
		      }
		    }
		  ],

		  layout: {
		    name: 'grid',
		    rows: 1
		  }

	});
	
	var cs = conn.getVertices("Country");
	for (c in cs) {
		cc = cs[c];
		cy.add({group: "nodes", data: {id: cc["v_type"] + "→" + cc["v_id"], v_id: cc["v_id"], v_type: cc["v_type"]}});
	}
	var ps = conn.getVertices("Province");
	for (p in ps) {
		pp = ps[p];
		cy.add({group: "nodes", data: {id: pp["v_type"] + "→" + pp["v_id"], v_id: pp["v_id"], v_type: pp["v_type"]}});
	}

	var c2p = conn.getEdgesByType("PROVINCE_IN_COUNTRY");
	for (e in c2p) {
		ee = c2p[e];
		source_v = ee["from_type"] + "→" + ee["from_id"];
		target_v = ee["to_type"] + "→" + ee["to_id"];
		cy.add({group: "edges", data: {id: ee["e_type"] + '⇒' + source_v + "⇒" + target_v, source: source_v, target: target_v}});
	}
	
	var layout = cy.layout({
		  name: 'cose'
		});

	layout.run();
</script>
</div>
</body>
</html>